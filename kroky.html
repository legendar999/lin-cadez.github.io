<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Menu</title>
  </head>
  <body>
    <h1>Menu</h1>
    <ul id="menu-list"></ul>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cheerio"></script>
    <script>
      // Get the current day of the week (Monday = 0, Sunday = 6)
      const today = new Date().getDay();

      // Subtract 1 from the current day to match the indexing used in the original script
      const day = today - 1;

      // Define labels for the days
      const dayLabels = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'];

      // Log in and get the required data
      const loginUrl = 'https://www.kroky.si/2016/?mod=register&action=login';
      const orderUrl = 'https://www.kroky.si/2016/?mod=register&action=order&pos=-1';
      const loginData = {
        username: 'ÄŒadLin',
        password: 'hlamehhit',
      };
      const headers = {};

      axios.post(loginUrl, loginData, { headers })
        .then(() => axios.get(orderUrl, { headers }))
        .then((response) => {
          // Extract the menu names and selected menu items from the response
          const $ = cheerio.load(response.data);
          const menus = $('span.lepo_ime').map((i, el) => $(el).text().trim()).get();
          const selected = $('input:checked').map((i, el) => $(el).attr('menu_id')).get().map((id) => parseInt(id, 10));

          // Create a dictionary to store the menus for each day of the week
          const menuDict = {};

          // Store the selected menu item for each day in the dictionary
          for (let i = 0; i < 5; i++) {
            const selectedMenu = menus[selected[0] - 1 + i * 5 + day];
            menuDict[dayLabels[i]] = selectedMenu;
          }

          const menuList = document.getElementById('menu-list');
          for (const [day, menu] of Object.entries(menuDict)) {
            const menuItem = document.createElement('li');
            menuItem.textContent = `${day}: ${menu}`;
            menuList.appendChild(menuItem);
          }
        })
        .catch((error) => console.error(error));
    </script>
  </body>
</html>
